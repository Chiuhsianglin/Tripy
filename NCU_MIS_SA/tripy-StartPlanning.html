<!DOCTYPE html>
<html lang="en">
<head>
	<title>tripy</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!--===============================================================================================-->	
	<link rel="icon" type="image/png" href="images/icons/favicon.png"/>
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
<!--===============================================================================================-->	
	<link rel="stylesheet" type="text/css" href="vendor/css-hamburgers/hamburgers.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/animsition/css/animsition.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/slick/slick.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="vendor/MagnificPopup/magnific-popup.css">
<!--===============================================================================================-->
	<link rel="stylesheet" type="text/css" href="css/util.min.css">
<!--===============================================================================================-->	
	<link rel="stylesheet" type="text/css" href="css/main.css">
<!--===============================================================================================-->
</head>
<body class="animsition">
	<!-- Header -->
	<header>
		<!-- Header desktop -->
		<nav class="container-header-desktop">
			<div class="wrap-menu-desktop">
				<div class="limiter-menu-desktop container">					
					<!-- Logo desktop -->		
					<div class="logo">
						<a href="index.html"><img src="images/icons/newlogo.png" alt="LOGO"></a>
					</div>
					<!-- Menu desktop -->
					<div class="menu-desktop">
						<ul class="main-menu respon-sub-menu" id="menu">
							<li>
								<a href="tripy-City.html" style="font-weight: bold;">景點</a>
							</li>

							<li>
								<a href="tripy-StartPlanning.html" style="font-weight: bold;">觀光行程</a>
							</li>

							<li>
								<a href="tripy-FavoriteList.html" style="font-weight: bold;">我的收藏</a>
							</li>

							<li>
								<a href="tripy-login.html" style="font-weight: bold;">登入</a>
								<ul class="sub-menu bold-chinese-text">
									<li><a href="tripy-SeeAllMember.html">檢視所有會員</a></li>
									<li><a href="tripy-SeeAllAdmin.html">檢視所有管理員</a></li>
									<li><a href="tripy-AddAdmin.html">新增管理員</a></li>
								</ul>
							</li>
						</ul>
					</div>					
				</div>
			</div>	
		</nav>

		<style>
			.size-a-7 {
				width: 50px;
				height: 50px;
			}
		</style>

		
	</header>
	<div class="col-lg-4 p-b-50 isotope-item self">
		<div class="flex-wr-s-c">
			<div id="CP">
				<button onclick="createPlan();" class="flex-c-c size-a-7 borad-50per bg-11 fs-20 cl-0 hov-btn2 trans-02 m-r-10">
					<i class="fa fa-plus"></i>	
				</button>
			</div>
		</div>
	</div>

	<!-- Content -->
	<div class="bg-0 p-t-95 p-b-50">
		<div class="container">
			<div class="isotope-grid" id ="Addplan">
					<!-- 行程 -->		
				
				<div class="col-lg-4 p-b-50 isotope-item self">
					<div class="bg-0 h-full">
						<a href="Itinerary.html" class="hov-img0 of-hidden">
							<img src="images/台南.jpg" alt="IMG" height= "200px">
						</a>

						<div class="bg-0 p-t-20">
							<h4 class="p-b-12">
								<a href="Itinerary.html" class="t1-m-1 cl-3 hov-link2 trans-02">
									規劃臺南兩天一夜
								</a>
							</h4>
							
							<div class="flex-wr-s-c p-b-15">
								<div class="p-r-20">
									<i class="fs-14 cl-7 fa fa-calendar m-r-2"></i>

									<a href="#" class="t1-s-2 cl-11 hov-link3">
										2023/12/4 - 2023/12/5
									</a>
								</div>

								<div class="p-rl-20 bo-l-1 bcl-12">
									<i class="fs-14 cl-7 fa fa-user m-r-2"></i>

									<a href="#" class="t1-s-2 cl-11 hov-link3">
										管理
									</a>
								</div>
								<div>

								</div>

								<div class="p-l-20 bo-l-1 bcl-12">
									<i class="fs-14 cl-7 fa fa-pencil m-r-2"></i>

									<a href="#" class="t1-s-2 cl-11 hov-link3">
										編輯
									</a>
								</div>

							</div>

							<a href="Itinerary.html" class="d-inline-flex flex-c-c size-a-1 p-rl-15 t1-s-2 text-uppercase cl-0 bg-11 hov-btn1 trans-02">
								開始規劃
							</a>
						</div>
					</div>
				</div>
				
					
			</div>
		</div>
	</div>
	
	
	<!-- Footer -->
	<footer>
		
	</footer>


<!--===============================================================================================-->	
	<script src="vendor/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/bootstrap/js/popper.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/select2/select2.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/parallax100/parallax100.js"></script>
<!--===============================================================================================-->
	<script src="vendor/waypoint/jquery.waypoints.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/countterup/jquery.counterup.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/slick/slick.min.js"></script>
	<script src="js/slick-custom.js"></script>
<!--===============================================================================================-->
	<script src="vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>
<!--===============================================================================================-->
	<script src="vendor/isotope/isotope.pkgd.min.js"></script>
<!--===============================================================================================-->
	<script src="js/main.js"></script>
    <!-- SweetAlert的JS套件 -->
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

	 <!-- 新增清單 -->
	 <script type="text/javascript">
		$(document).ready(function () {
			var $topeContainer;

			// 初始化 Isotope
			$topeContainer = $('#Addplan');
			$topeContainer.isotope({
				itemSelector: '.isotope-item',
				layoutMode: 'fitRows',
				percentPosition: true,
				animationEngine: 'best-available',
				masonry: {
					columnWidth: '.isotope-item'
				}
			});

			// 其他代碼...
		});


		var createPlan = function () {
		  swal({
			title: "新增旅遊計畫",
			content: {
			  element: "input",
			  attributes: {
				placeholder: "輸入計畫名稱",
				type: "text",
			  },
			},
			buttons: {
			  Btn: false,
			  confirm: {
				text: "確認",
				visible: true,
			  },
			  cancel: {
				text: "取消",
				visible: true,
			  },
			},
		  }).then((value) => {
			if (value !== null) {
			  // 檢查使用者是否按下確認按鈕
			  if (value !== "" && value !== null) {
				// 動態新增一個帶有 class 和 id 的 div 元素到指定的父元素中
				createDiv(value, "Addplan");
			  } else {
				swal("您未輸入任何文字");
			  }
			} else {
			  // 使用者按下取消按鈕
			  swal.close();
			}
		  });
		};
  
		// 動態新增 div 的函數
		function createDiv(value, parentID) {
		  // 獲取指定的父元素
		  var parentElement = document.getElementById(parentID);
  
		  // 檢查父元素是否存在
		  if (parentElement) {
			// 創建一個新的 div 元素
			var newDiv = document.createElement("li");
			newDiv,style = "font-weight: bold;"
			//newDiv.className = "CollectList";
			//newDiv.id = "list_tainan"; // 設定 id
			//newDiv.style.display = "inline-block"; // 設定為 inline-block
  
			newDiv.innerHTML = `
			<a href="tripy-FavoriteList.html" style="font-weight: bold;">${value}</a>

			`;
			
			// 將新的 div 元素添加到指定的父元素中
			parentElement.appendChild(newDiv);
			$topeContainer.isotope('layout');
		  } else {
			console.error("找不到指定的父元素");
		  }
		}
   
		
		var url_string = window.location.href;
  		var url = new URL(url_string);
  		var city_id = url.searchParams.get("user_id");	
  		
  		function getStartPlanningData() {
		  	$.ajax({
	          type: "GET",
	          url: "api/ItineraryList.do",
	          data: "user_id=" + user_id,
	          crossDomain: true,
	          cache: false,
	          dataType: 'json',
	          timeout: 5000,
	          success: function (response) {
	              if(response.status == 200){
	            	  updateHTML(response.response.data);
	              }
	          },
	          error: function () {
	              alert("無法連線到伺服器！");
	          }
	    	});
	  	}
	  	getStartPlanningData();
  
		function updateHTML(data) {

			var inner_html = "";
			  
			$.each(data.scene_info, function (k, v) {
				inner_html += updateStartPlanningTable(v);
			});
			 
			$("#Addplan").append(inner_html);
		
		  }
		  
		function updateStartPlanningTable(data) {
			var table_html = "";
			table_html +=   '<div class="col-lg-4 p-b-50 isotope-item self">'
			table_html +=	'<div class="bg-0 h-full">'
			table_html +=	'<a href="Itinerary.html" class="hov-img0 of-hidden">'
			table_html +=	'<img src="images/台南.jpg" alt="IMG" height= "200px">'
			table_html +=	'</a>'
			table_html +=	'<div class="bg-0 p-t-20">'
			table_html +=	'<h4 class="p-b-12">'
			table_html +=	'<a href="Itinerary.html" class="t1-m-1 cl-3 hov-link2 trans-02">'
			table_html +=	data['name']
			table_html +=	'</a>'
			table_html +=	'</h4>'
			table_html +=	'<div class="flex-wr-s-c p-b-15">'
			table_html +=	'<div class="p-r-20">'
			table_html +=	'<i class="fs-14 cl-7 fa fa-calendar m-r-2"></i>'
			table_html +=	'<a href="#" class="t1-s-2 cl-11 hov-link3">'
			table_html +=	data['start']				
			table_html +=   data['end']
			table_html +=	'</a>'
			table_html +=	'</div>'
			table_html +=	'<div class="p-rl-20 bo-l-1 bcl-12">'
			table_html +=	'<i class="fs-14 cl-7 fa fa-user m-r-2"></i>'
			table_html +=	'<a href="#" class="t1-s-2 cl-11 hov-link3">管理</a>'
			table_html +=	'</div>'
			table_html +=	'<div>'	
			table_html +=	'</div>'
			table_html +=	'<div class="p-l-20 bo-l-1 bcl-12">'
			table_html +=	'<i class="fs-14 cl-7 fa fa-pencil m-r-2"></i>'
			table_html +=	'<a href="#" class="t1-s-2 cl-11 hov-link3">編輯</a>'		
			table_html +=	'</div>'		
			table_html +=	'</div>'	
			table_html +=	'<a href="Itinerary.html" class="d-inline-flex flex-c-c size-a-1 p-rl-15 t1-s-2 text-uppercase cl-0 bg-11 hov-btn1 trans-02">開始規劃</a>'
			table_html +=	'</div>'		
			table_html +=	'</div>'
			table_html +=	'</div>'

			return table_html;		  
		  }
	</script>

</body>
</html>